<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AceTime: ace_time::clock::SystemClockLoop Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AceTime
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Date and time classes for Arduino that support timezones from the TZ Database, and a system clock that can synchronize from an NTP server or an RTC chip.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>ace_time</b></li><li class="navelem"><b>clock</b></li><li class="navelem"><a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html">SystemClockLoop</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classace__time_1_1clock_1_1SystemClockLoop-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ace_time::clock::SystemClockLoop Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A subclass of <a class="el" href="classace__time_1_1clock_1_1SystemClock.html" title="A Clock that uses the Arduino millis() function to advance the time returned to the user...">SystemClock</a> that sync with its mReferenceClock using a blocking mReferenceClock-&gt;<a class="el" href="classace__time_1_1clock_1_1SystemClock.html#acdb29aa7095759101a9f33b79f863144" title="Return the number of seconds since the AceTime epoch (2000-01-01T00:00:00Z). ">getNow()</a> call.  
 <a href="classace__time_1_1clock_1_1SystemClockLoop.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ace_time::clock::SystemClockLoop:</div>
<div class="dyncontent">
<div class="center"><img src="classace__time_1_1clock_1_1SystemClockLoop__inherit__graph.png" border="0" usemap="#ace__time_1_1clock_1_1SystemClockLoop_inherit__map" alt="Inheritance graph"/></div>
<map name="ace__time_1_1clock_1_1SystemClockLoop_inherit__map" id="ace__time_1_1clock_1_1SystemClockLoop_inherit__map">
<area shape="rect" id="node2" href="classace__time_1_1clock_1_1SystemClock.html" title="A Clock that uses the Arduino millis() function to advance the time returned to the user..." alt="" coords="19,80,221,107"/>
<area shape="rect" id="node3" href="classace__time_1_1clock_1_1Clock.html" title="Base class for objects that provide and store time. " alt="" coords="42,5,198,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ace_time::clock::SystemClockLoop:</div>
<div class="dyncontent">
<div class="center"><img src="classace__time_1_1clock_1_1SystemClockLoop__coll__graph.png" border="0" usemap="#ace__time_1_1clock_1_1SystemClockLoop_coll__map" alt="Collaboration graph"/></div>
<map name="ace__time_1_1clock_1_1SystemClockLoop_coll__map" id="ace__time_1_1clock_1_1SystemClockLoop_coll__map">
<area shape="rect" id="node2" href="classace__time_1_1clock_1_1SystemClock.html" title="A Clock that uses the Arduino millis() function to advance the time returned to the user..." alt="" coords="19,109,221,136"/>
<area shape="rect" id="node3" href="classace__time_1_1clock_1_1Clock.html" title="Base class for objects that provide and store time. " alt="" coords="42,5,198,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad9551e6d6778fd0dd8aa63798c310a70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#ad9551e6d6778fd0dd8aa63798c310a70">SystemClockLoop</a> (<a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *referenceClock, <a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *backupClock, uint16_t syncPeriodSeconds=3600, uint16_t initialSyncPeriodSeconds=5, uint16_t requestTimeoutMillis=1000, <a class="el" href="classace__time_1_1common_1_1TimingStats.html">common::TimingStats</a> *timingStats=nullptr)</td></tr>
<tr class="memdesc:ad9551e6d6778fd0dd8aa63798c310a70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ad9551e6d6778fd0dd8aa63798c310a70">More...</a><br /></td></tr>
<tr class="separator:ad9551e6d6778fd0dd8aa63798c310a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a551fc36219fa3afb4e78a8c690a07fc8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#a551fc36219fa3afb4e78a8c690a07fc8">loop</a> ()</td></tr>
<tr class="memdesc:a551fc36219fa3afb4e78a8c690a07fc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this from the global <a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#a551fc36219fa3afb4e78a8c690a07fc8" title="Call this from the global loop() method. ">loop()</a> method.  <a href="#a551fc36219fa3afb4e78a8c690a07fc8">More...</a><br /></td></tr>
<tr class="separator:a551fc36219fa3afb4e78a8c690a07fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classace__time_1_1clock_1_1SystemClock"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classace__time_1_1clock_1_1SystemClock')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classace__time_1_1clock_1_1SystemClock.html">ace_time::clock::SystemClock</a></td></tr>
<tr class="memitem:a8d9d0d7e3bbf66b45cf6010df983c6c2 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#a8d9d0d7e3bbf66b45cf6010df983c6c2">setup</a> ()</td></tr>
<tr class="memdesc:a8d9d0d7e3bbf66b45cf6010df983c6c2 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to retrieve the time from the backupClock if it exists.  <a href="classace__time_1_1clock_1_1SystemClock.html#a8d9d0d7e3bbf66b45cf6010df983c6c2">More...</a><br /></td></tr>
<tr class="separator:a8d9d0d7e3bbf66b45cf6010df983c6c2 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdb29aa7095759101a9f33b79f863144 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">acetime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#acdb29aa7095759101a9f33b79f863144">getNow</a> () const override</td></tr>
<tr class="memdesc:acdb29aa7095759101a9f33b79f863144 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of seconds since the AceTime epoch (2000-01-01T00:00:00Z).  <a href="classace__time_1_1clock_1_1SystemClock.html#acdb29aa7095759101a9f33b79f863144">More...</a><br /></td></tr>
<tr class="separator:acdb29aa7095759101a9f33b79f863144 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33cfb495e1b6247916b986bbef6875d inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#aa33cfb495e1b6247916b986bbef6875d">setNow</a> (acetime_t epochSeconds) override</td></tr>
<tr class="memdesc:aa33cfb495e1b6247916b986bbef6875d inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the time to the indicated seconds.  <a href="classace__time_1_1clock_1_1SystemClock.html#aa33cfb495e1b6247916b986bbef6875d">More...</a><br /></td></tr>
<tr class="separator:aa33cfb495e1b6247916b986bbef6875d inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95cf4f181a152702605e5d607ca79eea inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#a95cf4f181a152702605e5d607ca79eea">forceSync</a> ()</td></tr>
<tr class="memdesc:a95cf4f181a152702605e5d607ca79eea inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force a sync with the mReferenceClock.  <a href="classace__time_1_1clock_1_1SystemClock.html#a95cf4f181a152702605e5d607ca79eea">More...</a><br /></td></tr>
<tr class="separator:a95cf4f181a152702605e5d607ca79eea inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a18e2aa66cb889e64579da2e8dcdd5d inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">acetime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#a0a18e2aa66cb889e64579da2e8dcdd5d">getLastSyncTime</a> () const</td></tr>
<tr class="memdesc:a0a18e2aa66cb889e64579da2e8dcdd5d inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the time (seconds since Epoch) of the last valid sync() call.  <a href="classace__time_1_1clock_1_1SystemClock.html#a0a18e2aa66cb889e64579da2e8dcdd5d">More...</a><br /></td></tr>
<tr class="separator:a0a18e2aa66cb889e64579da2e8dcdd5d inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02d0f3bcc25db646fe41edc5a424975 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#ae02d0f3bcc25db646fe41edc5a424975">isInit</a> () const</td></tr>
<tr class="memdesc:ae02d0f3bcc25db646fe41edc5a424975 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if initialized by <a class="el" href="classace__time_1_1clock_1_1SystemClock.html#aa33cfb495e1b6247916b986bbef6875d" title="Set the time to the indicated seconds. ">setNow()</a> or <a class="el" href="classace__time_1_1clock_1_1SystemClock.html#acfd32b4775a05ff54d172f3829fc1de7" title="Similar to setNow() except that backupNow() is called only if the backupClock is different from the r...">syncNow()</a>.  <a href="classace__time_1_1clock_1_1SystemClock.html#ae02d0f3bcc25db646fe41edc5a424975">More...</a><br /></td></tr>
<tr class="separator:ae02d0f3bcc25db646fe41edc5a424975 inherit pub_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classace__time_1_1clock_1_1Clock"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classace__time_1_1clock_1_1Clock')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classace__time_1_1clock_1_1Clock.html">ace_time::clock::Clock</a></td></tr>
<tr class="memitem:ad68077ac3bb5077e6751193b7f945263 inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1Clock.html#ad68077ac3bb5077e6751193b7f945263">~Clock</a> ()</td></tr>
<tr class="memdesc:ad68077ac3bb5077e6751193b7f945263 inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor.  <a href="classace__time_1_1clock_1_1Clock.html#ad68077ac3bb5077e6751193b7f945263">More...</a><br /></td></tr>
<tr class="separator:ad68077ac3bb5077e6751193b7f945263 inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a789be177b3a48408fca1805a90d7e34e inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1Clock.html#a789be177b3a48408fca1805a90d7e34e">sendRequest</a> () const</td></tr>
<tr class="memdesc:a789be177b3a48408fca1805a90d7e34e inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a time request asynchronously.  <a href="classace__time_1_1clock_1_1Clock.html#a789be177b3a48408fca1805a90d7e34e">More...</a><br /></td></tr>
<tr class="separator:a789be177b3a48408fca1805a90d7e34e inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada1474de64fd88ca8466bea08165b3c3 inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1Clock.html#ada1474de64fd88ca8466bea08165b3c3">isResponseReady</a> () const</td></tr>
<tr class="memdesc:ada1474de64fd88ca8466bea08165b3c3 inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if a response is ready.  <a href="classace__time_1_1clock_1_1Clock.html#ada1474de64fd88ca8466bea08165b3c3">More...</a><br /></td></tr>
<tr class="separator:ada1474de64fd88ca8466bea08165b3c3 inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb014777a376ad582151486b64db67fc inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memItemLeft" align="right" valign="top">virtual acetime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1Clock.html#acb014777a376ad582151486b64db67fc">readResponse</a> () const</td></tr>
<tr class="memdesc:acb014777a376ad582151486b64db67fc inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns number of seconds since AceTime epoch (2000-01-01).  <a href="classace__time_1_1clock_1_1Clock.html#acb014777a376ad582151486b64db67fc">More...</a><br /></td></tr>
<tr class="separator:acb014777a376ad582151486b64db67fc inherit pub_methods_classace__time_1_1clock_1_1Clock"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a90c78d608597344d6a939039d68cff29"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#a90c78d608597344d6a939039d68cff29">kStatusReady</a> = 0</td></tr>
<tr class="memdesc:a90c78d608597344d6a939039d68cff29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ready to send request.  <a href="#a90c78d608597344d6a939039d68cff29">More...</a><br /></td></tr>
<tr class="separator:a90c78d608597344d6a939039d68cff29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa004e86b139fd89f1ff5448797e7e6a"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#afa004e86b139fd89f1ff5448797e7e6a">kStatusSent</a> = 1</td></tr>
<tr class="memdesc:afa004e86b139fd89f1ff5448797e7e6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request sent, waiting for response.  <a href="#afa004e86b139fd89f1ff5448797e7e6a">More...</a><br /></td></tr>
<tr class="separator:afa004e86b139fd89f1ff5448797e7e6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2aa47f5d566c4692aba7afb2bb5c452"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#ad2aa47f5d566c4692aba7afb2bb5c452">kStatusOk</a> = 2</td></tr>
<tr class="memdesc:ad2aa47f5d566c4692aba7afb2bb5c452"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request received and is valid.  <a href="#ad2aa47f5d566c4692aba7afb2bb5c452">More...</a><br /></td></tr>
<tr class="separator:ad2aa47f5d566c4692aba7afb2bb5c452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845c17d094b303a9cf7ca38d34df0982"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#a845c17d094b303a9cf7ca38d34df0982">kStatusWaitForRetry</a> = 3</td></tr>
<tr class="memdesc:a845c17d094b303a9cf7ca38d34df0982"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request received but is invalid, so retry with exponential backoff.  <a href="#a845c17d094b303a9cf7ca38d34df0982">More...</a><br /></td></tr>
<tr class="separator:a845c17d094b303a9cf7ca38d34df0982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classace__time_1_1clock_1_1Clock"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classace__time_1_1clock_1_1Clock')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classace__time_1_1clock_1_1Clock.html">ace_time::clock::Clock</a></td></tr>
<tr class="memitem:ae4fb852c09fbb9e37cc5764787dbf094 inherit pub_static_attribs_classace__time_1_1clock_1_1Clock"><td class="memItemLeft" align="right" valign="top"><a id="ae4fb852c09fbb9e37cc5764787dbf094"></a>
static const acetime_t&#160;</td><td class="memItemRight" valign="bottom"><b>kInvalidSeconds</b> = LocalTime::kInvalidSeconds</td></tr>
<tr class="separator:ae4fb852c09fbb9e37cc5764787dbf094 inherit pub_static_attribs_classace__time_1_1clock_1_1Clock"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a22bf4c77367e71425abbe5c27007bba5"><td class="memItemLeft" align="right" valign="top"><a id="a22bf4c77367e71425abbe5c27007bba5"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>::SystemClockLoopTest_loop</b></td></tr>
<tr class="separator:a22bf4c77367e71425abbe5c27007bba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classace__time_1_1clock_1_1SystemClock"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classace__time_1_1clock_1_1SystemClock')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classace__time_1_1clock_1_1SystemClock.html">ace_time::clock::SystemClock</a></td></tr>
<tr class="memitem:a83e50e2b88d46e5c9e5e9a8362f2e4d8 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="a83e50e2b88d46e5c9e5e9a8362f2e4d8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>SystemClock</b> (const <a class="el" href="classace__time_1_1clock_1_1SystemClock.html">SystemClock</a> &amp;)=delete</td></tr>
<tr class="separator:a83e50e2b88d46e5c9e5e9a8362f2e4d8 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49f56a854721e62634f0b453ef615ae inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="ac49f56a854721e62634f0b453ef615ae"></a>
<a class="el" href="classace__time_1_1clock_1_1SystemClock.html">SystemClock</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classace__time_1_1clock_1_1SystemClock.html">SystemClock</a> &amp;)=delete</td></tr>
<tr class="separator:ac49f56a854721e62634f0b453ef615ae inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38ad78cf1a28854b54225a33d16a9bd4 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#a38ad78cf1a28854b54225a33d16a9bd4">SystemClock</a> (<a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *referenceClock, <a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *backupClock)</td></tr>
<tr class="memdesc:a38ad78cf1a28854b54225a33d16a9bd4 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classace__time_1_1clock_1_1SystemClock.html#a38ad78cf1a28854b54225a33d16a9bd4">More...</a><br /></td></tr>
<tr class="separator:a38ad78cf1a28854b54225a33d16a9bd4 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa93c64a26f9dab8cd364dd7c0cb798 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">virtual unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#a1aa93c64a26f9dab8cd364dd7c0cb798">clockMillis</a> () const</td></tr>
<tr class="memdesc:a1aa93c64a26f9dab8cd364dd7c0cb798 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the Arduino millis().  <a href="classace__time_1_1clock_1_1SystemClock.html#a1aa93c64a26f9dab8cd364dd7c0cb798">More...</a><br /></td></tr>
<tr class="separator:a1aa93c64a26f9dab8cd364dd7c0cb798 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfc9d74fc2b9a0356a44d1e41845b3de inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="adfc9d74fc2b9a0356a44d1e41845b3de"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#adfc9d74fc2b9a0356a44d1e41845b3de">keepAlive</a> ()</td></tr>
<tr class="memdesc:adfc9d74fc2b9a0356a44d1e41845b3de inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this (or <a class="el" href="classace__time_1_1clock_1_1SystemClock.html#acdb29aa7095759101a9f33b79f863144" title="Return the number of seconds since the AceTime epoch (2000-01-01T00:00:00Z). ">getNow()</a> every 65.535 seconds or faster to keep the internal counter in sync with millis(). <br /></td></tr>
<tr class="separator:adfc9d74fc2b9a0356a44d1e41845b3de inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd779bb277217f23fbcc96482d276584 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="afd779bb277217f23fbcc96482d276584"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#afd779bb277217f23fbcc96482d276584">backupNow</a> (acetime_t nowSeconds)</td></tr>
<tr class="memdesc:afd779bb277217f23fbcc96482d276584 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the nowSeconds to the backupClock (which can be an RTC that has non-volatile memory, or simply flash memory which emulates a backupClock. <br /></td></tr>
<tr class="separator:afd779bb277217f23fbcc96482d276584 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfd32b4775a05ff54d172f3829fc1de7 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__time_1_1clock_1_1SystemClock.html#acfd32b4775a05ff54d172f3829fc1de7">syncNow</a> (acetime_t epochSeconds)</td></tr>
<tr class="memdesc:acfd32b4775a05ff54d172f3829fc1de7 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="mdescLeft">&#160;</td><td class="mdescRight">Similar to <a class="el" href="classace__time_1_1clock_1_1SystemClock.html#aa33cfb495e1b6247916b986bbef6875d" title="Set the time to the indicated seconds. ">setNow()</a> except that <a class="el" href="classace__time_1_1clock_1_1SystemClock.html#afd779bb277217f23fbcc96482d276584" title="Write the nowSeconds to the backupClock (which can be an RTC that has non-volatile memory...">backupNow()</a> is called only if the backupClock is different from the referenceClock.  <a href="classace__time_1_1clock_1_1SystemClock.html#acfd32b4775a05ff54d172f3829fc1de7">More...</a><br /></td></tr>
<tr class="separator:acfd32b4775a05ff54d172f3829fc1de7 inherit pro_methods_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classace__time_1_1clock_1_1SystemClock"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classace__time_1_1clock_1_1SystemClock')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classace__time_1_1clock_1_1SystemClock.html">ace_time::clock::SystemClock</a></td></tr>
<tr class="memitem:a6f56d513665b1e247380d094719c1e73 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="a6f56d513665b1e247380d094719c1e73"></a>
<a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *const&#160;</td><td class="memItemRight" valign="bottom"><b>mReferenceClock</b></td></tr>
<tr class="separator:a6f56d513665b1e247380d094719c1e73 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6abfde71246c6f1d546c151bf74a1f1 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="ad6abfde71246c6f1d546c151bf74a1f1"></a>
<a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *const&#160;</td><td class="memItemRight" valign="bottom"><b>mBackupClock</b></td></tr>
<tr class="separator:ad6abfde71246c6f1d546c151bf74a1f1 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc9d0d304368cc452ec2a5205667eef3 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="acc9d0d304368cc452ec2a5205667eef3"></a>
acetime_t&#160;</td><td class="memItemRight" valign="bottom"><b>mEpochSeconds</b> = kInvalidSeconds</td></tr>
<tr class="separator:acc9d0d304368cc452ec2a5205667eef3 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80206258d76bd6eb69e87e9975cf7d6f inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="a80206258d76bd6eb69e87e9975cf7d6f"></a>
acetime_t&#160;</td><td class="memItemRight" valign="bottom"><b>mLastSyncTime</b> = kInvalidSeconds</td></tr>
<tr class="separator:a80206258d76bd6eb69e87e9975cf7d6f inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29219ffa507b7da53e6a346922f6502f inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="a29219ffa507b7da53e6a346922f6502f"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>mPrevMillis</b> = 0</td></tr>
<tr class="separator:a29219ffa507b7da53e6a346922f6502f inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74473c352a367cb3e28024efba9d3481 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memItemLeft" align="right" valign="top"><a id="a74473c352a367cb3e28024efba9d3481"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>mIsInit</b> = false</td></tr>
<tr class="separator:a74473c352a367cb3e28024efba9d3481 inherit pro_attribs_classace__time_1_1clock_1_1SystemClock"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A subclass of <a class="el" href="classace__time_1_1clock_1_1SystemClock.html" title="A Clock that uses the Arduino millis() function to advance the time returned to the user...">SystemClock</a> that sync with its mReferenceClock using a blocking mReferenceClock-&gt;<a class="el" href="classace__time_1_1clock_1_1SystemClock.html#acdb29aa7095759101a9f33b79f863144" title="Return the number of seconds since the AceTime epoch (2000-01-01T00:00:00Z). ">getNow()</a> call. </p>
<p>The blocking call can be a problem for clocks like <a class="el" href="classace__time_1_1clock_1_1NtpClock.html" title="A Clock that retrieves the time from an NTP server. ">NtpClock</a> which makes a network request. If this is a problem, use <a class="el" href="classace__time_1_1clock_1_1SystemClockCoroutine.html" title="A version of SystemClock that mixes in the ace_routine::Coroutine class so that that the non-block me...">SystemClockCoroutine</a> instead.</p>
<p>Initial syncing occurs at initialSyncPeriodSeconds interval, until the first successful sync, then subsequent syncing occurs at syncPeriodSeconds interval. Initial syncing implements an exponential backoff when the sync request fails, increasing from initialSyncPeriodSeconds to until a maximum of syncPeriodSeconds. </p>

<p class="definition">Definition at line <a class="el" href="SystemClockLoop_8h_source.html#l00029">29</a> of file <a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad9551e6d6778fd0dd8aa63798c310a70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9551e6d6778fd0dd8aa63798c310a70">&#9670;&nbsp;</a></span>SystemClockLoop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ace_time::clock::SystemClockLoop::SystemClockLoop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *&#160;</td>
          <td class="paramname"><em>referenceClock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classace__time_1_1clock_1_1Clock.html">Clock</a> *&#160;</td>
          <td class="paramname"><em>backupClock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>syncPeriodSeconds</em> = <code>3600</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>initialSyncPeriodSeconds</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>requestTimeoutMillis</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classace__time_1_1common_1_1TimingStats.html">common::TimingStats</a> *&#160;</td>
          <td class="paramname"><em>timingStats</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">referenceClock</td><td>The authoritative source of the time. If this is null, the object relies just on <a class="el" href="classace__time_1_1clock_1_1SystemClock.html#a1aa93c64a26f9dab8cd364dd7c0cb798" title="Return the Arduino millis(). ">clockMillis()</a> and the user to set the proper time using <a class="el" href="classace__time_1_1clock_1_1SystemClock.html#aa33cfb495e1b6247916b986bbef6875d" title="Set the time to the indicated seconds. ">setNow()</a>. </td></tr>
    <tr><td class="paramname">backupClock</td><td>An RTC chip which continues to keep time even when power is lost. Can be null. </td></tr>
    <tr><td class="paramname">syncPeriodSeconds</td><td>seconds between normal sync attempts (default 3600) </td></tr>
    <tr><td class="paramname">initialSyncPeriodSeconds</td><td>seconds between sync attempts when the systemClock is not initialized (default 5), exponentially increasing (2X) at each attempt until syncPeriodSeconds is reached </td></tr>
    <tr><td class="paramname">timingStats</td><td>internal statistics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SystemClockLoop_8h_source.html#l00058">58</a> of file <a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a551fc36219fa3afb4e78a8c690a07fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a551fc36219fa3afb4e78a8c690a07fc8">&#9670;&nbsp;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ace_time::clock::SystemClockLoop::loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Call this from the global <a class="el" href="classace__time_1_1clock_1_1SystemClockLoop.html#a551fc36219fa3afb4e78a8c690a07fc8" title="Call this from the global loop() method. ">loop()</a> method. </p>
<p>This uses a blocking call to the mReferenceClock. </p>

<p class="definition">Definition at line <a class="el" href="SystemClockLoop_8h_source.html#l00075">75</a> of file <a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad2aa47f5d566c4692aba7afb2bb5c452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2aa47f5d566c4692aba7afb2bb5c452">&#9670;&nbsp;</a></span>kStatusOk</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t ace_time::clock::SystemClockLoop::kStatusOk = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Request received and is valid. </p>

<p class="definition">Definition at line <a class="el" href="SystemClockLoop_8h_source.html#l00038">38</a> of file <a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>.</p>

</div>
</div>
<a id="a90c78d608597344d6a939039d68cff29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90c78d608597344d6a939039d68cff29">&#9670;&nbsp;</a></span>kStatusReady</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t ace_time::clock::SystemClockLoop::kStatusReady = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ready to send request. </p>

<p class="definition">Definition at line <a class="el" href="SystemClockLoop_8h_source.html#l00032">32</a> of file <a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>.</p>

</div>
</div>
<a id="afa004e86b139fd89f1ff5448797e7e6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa004e86b139fd89f1ff5448797e7e6a">&#9670;&nbsp;</a></span>kStatusSent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t ace_time::clock::SystemClockLoop::kStatusSent = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Request sent, waiting for response. </p>

<p class="definition">Definition at line <a class="el" href="SystemClockLoop_8h_source.html#l00035">35</a> of file <a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>.</p>

</div>
</div>
<a id="a845c17d094b303a9cf7ca38d34df0982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a845c17d094b303a9cf7ca38d34df0982">&#9670;&nbsp;</a></span>kStatusWaitForRetry</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t ace_time::clock::SystemClockLoop::kStatusWaitForRetry = 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Request received but is invalid, so retry with exponential backoff. </p>

<p class="definition">Definition at line <a class="el" href="SystemClockLoop_8h_source.html#l00041">41</a> of file <a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/brian/dev/AceTime/src/ace_time/clock/<a class="el" href="SystemClockLoop_8h_source.html">SystemClockLoop.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
